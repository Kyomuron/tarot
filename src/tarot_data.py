from __future__ import annotations

from dataclasses import dataclass


@dataclass(frozen=True)
class Card:
    id: str
    numeral: str
    name: str
    name_jp: str
    symbol: str
    suit: str
    keywords_up: str
    keywords_rev: str
    upright: str
    reversed: str

    def to_dict(self) -> dict[str, str]:
        return {
            "id": self.id,
            "numeral": self.numeral,
            "name": self.name,
            "name_jp": self.name_jp,
            "symbol": self.symbol,
            "suit": self.suit,
            "keywords_up": self.keywords_up,
            "keywords_rev": self.keywords_rev,
            "upright": self.upright,
            "reversed": self.reversed,
        }


_MAJOR_ARCANA_BASE: tuple[tuple[str, str, str, str, str], ...] = (
    ("m0", "0", "The Fool", "æ„šè€…", "ðŸƒ"),
    ("m1", "I", "The Magician", "é­”è¡“å¸«", "ðŸª„"),
    ("m2", "II", "The High Priestess", "å¥³æ•™çš‡", "ðŸŒ™"),
    ("m3", "III", "The Empress", "å¥³å¸", "ðŸ‘‘"),
    ("m4", "IV", "The Emperor", "çš‡å¸", "ðŸ›ï¸"),
    ("m5", "V", "The Hierophant", "æ•™çš‡", "ðŸ“¿"),
    ("m6", "VI", "The Lovers", "æ‹äºº", "ðŸ’•"),
    ("m7", "VII", "The Chariot", "æˆ¦è»Š", "âš”ï¸"),
    ("m8", "VIII", "Strength", "åŠ›", "ðŸ¦"),
    ("m9", "IX", "The Hermit", "éš è€…", "ðŸ”ï¸"),
    ("m10", "X", "Wheel of Fortune", "é‹å‘½ã®è¼ª", "â˜¸ï¸"),
    ("m11", "XI", "Justice", "æ­£ç¾©", "âš–ï¸"),
    ("m12", "XII", "The Hanged Man", "åŠã‚‹ã•ã‚ŒãŸç”·", "ðŸ”®"),
    ("m13", "XIII", "Death", "æ­»ç¥ž", "ðŸ¦‹"),
    ("m14", "XIV", "Temperance", "ç¯€åˆ¶", "ðŸº"),
    ("m15", "XV", "The Devil", "æ‚ªé­”", "ðŸ”—"),
    ("m16", "XVI", "The Tower", "å¡”", "âš¡"),
    ("m17", "XVII", "The Star", "æ˜Ÿ", "â­"),
    ("m18", "XVIII", "The Moon", "æœˆ", "ðŸŒ•"),
    ("m19", "XIX", "The Sun", "å¤ªé™½", "â˜€ï¸"),
    ("m20", "XX", "Judgement", "å¯©åˆ¤", "ðŸ“¯"),
    ("m21", "XXI", "The World", "ä¸–ç•Œ", "ðŸŒ"),
)

_MAJOR_KEYWORDS: dict[str, tuple[str, str, str, str]] = {
    "m0": ("å§‹ã¾ã‚Šãƒ»è‡ªç”±", "ç„¡è¨ˆç”»ãƒ»åœæ»ž", "æ–°ã—ã„æ—…è·¯ã¸ã®æ‰‰ãŒé–‹ã„ã¦ã„ã¾ã™ã€‚", "æº–å‚™ä¸è¶³ã®ã¾ã¾é€²ã‚€å‰ã«è¶³å…ƒã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚"),
    "m1": ("å‰µé€ ãƒ»å®Ÿè¡Œ", "è¿·èµ°ãƒ»éŽä¿¡", "é“å…·ã¯ã™ã§ã«æƒã£ã¦ã„ã¾ã™ã€‚ä»Šã¯å®Ÿè¡Œã®æ™‚ã§ã™ã€‚", "å™¨ç”¨ã•ãŒåˆ†æ•£ã—ã‚„ã™ã„æ™‚æœŸã€‚å„ªå…ˆé †ä½ã‚’ä¸€æœ¬åŒ–ã—ã¾ã—ã‚‡ã†ã€‚"),
    "m2": ("ç›´æ„Ÿãƒ»æ´žå¯Ÿ", "æ··ä¹±ãƒ»èª¤èª­", "é™ã‹ãªè¦³å¯ŸãŒçœŸå®Ÿã¸å°Žãã¾ã™ã€‚", "æƒ…å ±éŽå¤šã§åˆ¤æ–­ãŒéˆã‚‹æš—ç¤ºã€‚å†…é¢ã®å£°ã‚’å–ã‚Šæˆ»ã—ã¾ã—ã‚‡ã†ã€‚"),
    "m3": ("è±Šã‹ã•ãƒ»è‚²æˆ", "éŽä¿è­·ãƒ»æµªè²»", "è‚²ã¦ã‚‹ã»ã©æœªæ¥ãŒè±Šã‹ã«ãªã‚‹æµã‚Œã§ã™ã€‚", "ä¸Žãˆã™ãŽã§æ¶ˆè€—ã—ã‚„ã™ã„æ™‚ã€‚è‡ªå·±å›žå¾©ã‚’å„ªå…ˆã—ã¾ã—ã‚‡ã†ã€‚"),
    "m4": ("ç§©åºãƒ»å®‰å®š", "æ”¯é…ãƒ»ç¡¬ç›´", "ä»•çµ„ã¿åŒ–ãŒæˆæžœã‚’ä¼¸ã°ã—ã¾ã™ã€‚", "åŽ³ã—ã•ãŒå¼·ã™ãŽã‚‹æš—ç¤ºã€‚æŸ”è»Ÿãªèª¿æ•´ãŒå¿…è¦ã§ã™ã€‚"),
    "m5": ("å­¦ã³ãƒ»è¦ç¯„", "ç›²ä¿¡ãƒ»åç™º", "å…ˆäººã®çŸ¥æµã‹ã‚‰æœ‰åŠ¹ãªæ‰‹ãŒã‹ã‚Šã‚’å¾—ã‚‰ã‚Œã¾ã™ã€‚", "å½¢å¼ã«ç¸›ã‚‰ã‚Œã™ãŽã‚‹æš—ç¤ºã€‚ç›®çš„ã‚’å†ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚"),
    "m6": ("èª¿å’Œãƒ»é¸æŠž", "è¿·ã„ãƒ»ä¸ä¸€è‡´", "ä¾¡å€¤è¦³ã®ä¸€è‡´ãŒå‰é€²ã‚’ç”Ÿã¿ã¾ã™ã€‚", "é–¢ä¿‚ã‚„é¸æŠžã®ã‚ºãƒ¬ã‚’ä¸å¯§ã«ä¿®æ­£ã—ã¾ã—ã‚‡ã†ã€‚"),
    "m7": ("å‰é€²ãƒ»å‹åˆ©", "æš´èµ°ãƒ»åœæ»ž", "å¼·ã„æ„æ€ãŒçªç ´å£ã‚’ä½œã‚Šã¾ã™ã€‚", "å‹¢ã„ä»»ã›ã¯å¤±é€Ÿã®å…ƒã€‚æ–¹å‘ä¿®æ­£ãŒéµã§ã™ã€‚"),
    "m8": ("å‹‡æ°—ãƒ»æŒä¹…åŠ›", "ä¸å®‰ãƒ»è‡ªä¿¡ä¸è¶³", "å„ªã—ã•ã‚’ä¼´ã†å¼·ã•ãŒçŠ¶æ³ã‚’æ•´ãˆã¾ã™ã€‚", "è‡ªå·±å¦å®šãŒå¼·ã¾ã‚‹æš—ç¤ºã€‚å°ã•ãªæˆåŠŸã‚’ç©ã¿é‡ã­ã¾ã—ã‚‡ã†ã€‚"),
    "m9": ("å†…çœãƒ»æŽ¢æ±‚", "å­¤ç«‹ãƒ»é–‰å¡ž", "ä¸€äººã§è€ƒãˆã‚‹æ™‚é–“ãŒè³ªã®é«˜ã„ç­”ãˆã‚’ç”Ÿã¿ã¾ã™ã€‚", "é–‰ã˜ã“ã‚‚ã‚Šã™ãŽã«æ³¨æ„ã€‚ä¿¡é ¼ã§ãã‚‹ç›¸æ‰‹ã«ç›¸è«‡ã‚’ã€‚"),
    "m10": ("è»¢æ©Ÿãƒ»å¥½æ©Ÿ", "é€†é¢¨ãƒ»é…å»¶", "æµã‚ŒãŒå¤‰ã‚ã‚‹è¿½ã„é¢¨ã€‚æ©Ÿä¼šã‚’æŽ´ã‚€æº–å‚™ã‚’ã€‚", "æ³¢ãŒä¸å®‰å®šãªæ™‚ã€‚é•·æœŸè¦–ç‚¹ã§å¾…ã¤ã®ãŒå¾—ç­–ã§ã™ã€‚"),
    "m11": ("å…¬æ­£ãƒ»å‡è¡¡", "åã‚Šãƒ»ä¸å…¬å¹³", "äº‹å®Ÿãƒ™ãƒ¼ã‚¹ã®åˆ¤æ–­ãŒè©•ä¾¡ã•ã‚Œã¾ã™ã€‚", "æ„Ÿæƒ…çš„ãªåˆ¤æ–­ã‚’é¿ã‘ã€æ¡ä»¶ã‚’æƒãˆã¾ã—ã‚‡ã†ã€‚"),
    "m12": ("è¦–ç‚¹è»¢æ›ãƒ»å—å®¹", "æŠµæŠ—ãƒ»åœæ»ž", "ç«‹ã¡æ­¢ã¾ã‚‹ã“ã¨ã§æ–°ã—ã„è¦–ç•ŒãŒé–‹ã‘ã¾ã™ã€‚", "æ‰‹æ”¾ã›ãªã„åŸ·ç€ãŒé€²è¡Œã‚’æ­¢ã‚ã¦ã„ã¾ã™ã€‚"),
    "m13": ("çµ‚ç„‰ãƒ»å†ç”Ÿ", "åœæ»žãƒ»æœªç·´", "çµ‚ã‚ã‚‰ã›ã‚‹å‹‡æ°—ãŒå†ç”Ÿã‚’å‘¼ã³ã¾ã™ã€‚", "å¤‰åŒ–ã‚’æ‹’ã‚€ã»ã©è² æ‹…ãŒå¢—ãˆã‚‹æ™‚æœŸã§ã™ã€‚"),
    "m14": ("èª¿å’Œãƒ»ç¯€åº¦", "éŽå‰°ãƒ»ä¸å‡è¡¡", "é…åˆ†ã®æœ€é©åŒ–ãŒçµæžœã‚’å®‰å®šã•ã›ã¾ã™ã€‚", "æ¥µç«¯ãªé¸æŠžã‚’é¿ã‘ã€æ•´ãˆã‚‹ã“ã¨ã‚’å„ªå…ˆã—ã¾ã—ã‚‡ã†ã€‚"),
    "m15": ("æ¬²æœ›ãƒ»æŸç¸›", "è§£æ”¾ãƒ»è¦šé†’", "ä¾å­˜ã®æ§‹é€ ã‚’è¦‹æŠœãã“ã¨ãŒç¬¬ä¸€æ­©ã§ã™ã€‚", "éŽ–ã‹ã‚‰é›¢ã‚Œã‚‹æº–å‚™ãŒæ•´ã£ã¦ã„ã¾ã™ã€‚"),
    "m16": ("å´©å£Šãƒ»åˆ·æ–°", "å…ˆå»¶ã°ã—ãƒ»é˜²è¡›", "å£Šã‚Œã‚‹ã“ã¨ã¯å†æ§‹ç¯‰ã®å‰æã§ã™ã€‚", "å•é¡Œã®å…ˆé€ã‚Šã‚’ã‚„ã‚ã‚‹ã“ã¨ã§è¢«å®³ã‚’æœ€å°åŒ–ã§ãã¾ã™ã€‚"),
    "m17": ("å¸Œæœ›ãƒ»å›žå¾©", "å¤±æœ›ãƒ»ä¸ä¿¡", "å›žå¾©ã®å…‰ãŒè¦‹ãˆã¦ã„ã¾ã™ã€‚ä¿¡ã˜ã¦é€²ã¿ã¾ã—ã‚‡ã†ã€‚", "å°ã•ãªå¸Œæœ›ã®å†ç™ºè¦‹ãŒå¿…è¦ã§ã™ã€‚"),
    "m18": ("æ„Ÿå—æ€§ãƒ»æ½œåœ¨æ„è­˜", "ä¸å®‰ãƒ»éŒ¯è¦š", "æ›–æ˜§ã•ã®ä¸­ã§ã¯ç›´æ„ŸãŒæœ‰åŠ¹ã§ã™ã€‚", "æ€ã„è¾¼ã¿ã‚’æ¤œè¨¼ã—ã€äº‹å®Ÿç¢ºèªã‚’å„ªå…ˆã—ã¾ã—ã‚‡ã†ã€‚"),
    "m19": ("æˆåŠŸãƒ»æ´»åŠ›", "éŽä¿¡ãƒ»ç©ºå›žã‚Š", "æ˜Žã‚‹ã„å±•é–‹ã€‚æˆæžœã‚’å—ã‘å–ã‚‹æ™‚ã§ã™ã€‚", "å‹¢ã„ã‚’åˆ¶å¾¡ã—ã¦æŒç¶šå¯èƒ½ãªå½¢ã«æ•´ãˆã¾ã—ã‚‡ã†ã€‚"),
    "m20": ("è¦šé†’ãƒ»æ±ºæ–­", "èºŠèº‡ãƒ»å¾Œæ‚”", "å¤§ããªæ±ºæ–­ã‚’è¡Œã†æº–å‚™ãŒæ•´ã£ã¦ã„ã¾ã™ã€‚", "éŽåŽ»ã¸ã®åŸ·ç€ã‚’æ‰‹æ”¾ã™ã»ã©å‰é€²ã—ã¾ã™ã€‚"),
    "m21": ("å®Œæˆãƒ»çµ±åˆ", "æœªå®Œãƒ»é…å»¶", "ä¸€åŒºåˆ‡ã‚Šã¨é”æˆã€‚æ¬¡ã®ç« ã¸ç§»ã‚‹åˆå›³ã§ã™ã€‚", "æœ€å¾Œã®ä»•ä¸Šã’ã‚’ä¸å¯§ã«è¡Œãˆã°å®Œæˆã—ã¾ã™ã€‚"),
}


_MINOR_SUITS: tuple[tuple[str, str, str, str], ...] = (
    ("wands", "Wands", "ãƒ¯ãƒ³ãƒ‰", "ðŸ”¥"),
    ("cups", "Cups", "ã‚«ãƒƒãƒ—", "ðŸ†"),
    ("swords", "Swords", "ã‚½ãƒ¼ãƒ‰", "âš”ï¸"),
    ("pentacles", "Pentacles", "ãƒšãƒ³ã‚¿ã‚¯ãƒ«", "ðŸª™"),
)

_MINOR_RANKS: tuple[tuple[str, str, str, str], ...] = (
    ("ace", "Ace", "ã‚¨ãƒ¼ã‚¹", "A"),
    ("2", "Two", "2", "2"),
    ("3", "Three", "3", "3"),
    ("4", "Four", "4", "4"),
    ("5", "Five", "5", "5"),
    ("6", "Six", "6", "6"),
    ("7", "Seven", "7", "7"),
    ("8", "Eight", "8", "8"),
    ("9", "Nine", "9", "9"),
    ("10", "Ten", "10", "10"),
    ("page", "Page", "ãƒšã‚¤ã‚¸", "P"),
    ("knight", "Knight", "ãƒŠã‚¤ãƒˆ", "Kn"),
    ("queen", "Queen", "ã‚¯ã‚¤ãƒ¼ãƒ³", "Q"),
    ("king", "King", "ã‚­ãƒ³ã‚°", "K"),
)


def build_major_arcana() -> list[Card]:
    cards: list[Card] = []
    for card_id, numeral, name, name_jp, symbol in _MAJOR_ARCANA_BASE:
        keywords_up, keywords_rev, upright_msg, reversed_msg = _MAJOR_KEYWORDS[card_id]
        cards.append(
            Card(
                id=card_id,
                numeral=numeral,
                name=name,
                name_jp=name_jp,
                symbol=symbol,
                suit="major",
                keywords_up=keywords_up,
                keywords_rev=keywords_rev,
                upright=upright_msg,
                reversed=reversed_msg,
            )
        )
    return cards


def build_minor_arcana() -> list[Card]:
    cards: list[Card] = []
    for suit_key, suit_name, suit_name_jp, suit_symbol in _MINOR_SUITS:
        for rank_key, rank_name, rank_name_jp, rank_num in _MINOR_RANKS:
            full_name = f"{rank_name} of {suit_name}"
            full_name_jp = f"{suit_name_jp}ã®{rank_name_jp}"
            card_id = f"{suit_key}-{rank_key}"
            cards.append(
                Card(
                    id=card_id,
                    numeral=rank_num,
                    name=full_name,
                    name_jp=full_name_jp,
                    symbol=suit_symbol,
                    suit=suit_key,
                    keywords_up=f"{suit_name_jp}ã®æˆé•·ãƒ»å‰é€²",
                    keywords_rev=f"{suit_name_jp}ã®åœæ»žãƒ»è¦‹ç›´ã—",
                    upright=f"{full_name_jp}ã®æ­£ä½ç½®ã€‚æ®µéšŽçš„ã«çŠ¶æ³ãŒå¥½è»¢ã™ã‚‹æµã‚Œã§ã™ã€‚",
                    reversed=f"{full_name_jp}ã®é€†ä½ç½®ã€‚æ€¥ãŒãšè¨ˆç”»ã‚’å†èª¿æ•´ã—ã¾ã—ã‚‡ã†ã€‚",
                )
            )
    return cards


def build_deck(deck_filter: str = "all") -> list[Card]:
    major = build_major_arcana()
    minor = build_minor_arcana()

    if deck_filter == "major":
        return major
    if deck_filter in {"wands", "cups", "swords", "pentacles"}:
        return [card for card in minor if card.suit == deck_filter]
    return major + minor
